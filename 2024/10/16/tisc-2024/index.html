<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>TISC 2024 - Baby Flagchecker | Iscara</title><meta name="author" content="Iscara"><meta name="copyright" content="Iscara"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="TISC is a two-week online sequential style CTF competition hosted by CSIT, where participants solve a series of 12 challenges. Over 1300 participants took on the challenges, with the top three levels">
<meta property="og:type" content="article">
<meta property="og:title" content="TISC 2024 - Baby Flagchecker">
<meta property="og:url" content="http://iscaraca.github.io/2024/10/16/tisc-2024/index.html">
<meta property="og:site_name" content="Iscara">
<meta property="og:description" content="TISC is a two-week online sequential style CTF competition hosted by CSIT, where participants solve a series of 12 challenges. Over 1300 participants took on the challenges, with the top three levels">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://iscaraca.github.io/img/avatar-icon.png">
<meta property="article:published_time" content="2024-10-15T16:00:00.000Z">
<meta property="article:modified_time" content="2025-05-31T08:45:05.818Z">
<meta property="article:author" content="Iscara">
<meta property="article:tag" content="Challenge Creation">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://iscaraca.github.io/img/avatar-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TISC 2024 - Baby Flagchecker",
  "url": "http://iscaraca.github.io/2024/10/16/tisc-2024/",
  "image": "http://iscaraca.github.io/img/avatar-icon.png",
  "datePublished": "2024-10-15T16:00:00.000Z",
  "dateModified": "2025-05-31T08:45:05.818Z",
  "author": [
    {
      "@type": "Person",
      "name": "Iscara",
      "url": "http://iscaraca.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://iscaraca.github.io/2024/10/16/tisc-2024/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TISC 2024 - Baby Flagchecker',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/cobaltcore-bg.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cobaltcore.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Iscara</span></a><a class="nav-page-title" href="/"><span class="site-name">TISC 2024 - Baby Flagchecker</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">TISC 2024 - Baby Flagchecker</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-10-15T16:00:00.000Z" title="Created 2024-10-16 00:00:00">2024-10-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-31T08:45:05.818Z" title="Updated 2025-05-31 16:45:05">2025-05-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Writeups/">CTF Writeups</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>TISC is a two-week online sequential style CTF competition hosted by CSIT, where participants solve a series of 12 challenges. Over 1300 participants took on the challenges, with the top three levels of challenges having a cash prize pool of $10,000 each to be shared between participants who’ve successfully cleared the respective levels.</p>
<p>I was given the opportunity to create the challenge at level 7, a Web3 reverse engineering&#x2F;binary exploitation challenge. I’ll be sharing the writeup, as well as source code and my thoughts, at the end of the blog post. You can check out the <a target="_blank" rel="noopener" href="https://www.csit.gov.sg/events/tisc/tisc-2024">statistics for the ctf here</a>. 17 people managed to solve my challenge; thank you friends.</p>
<h2 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>📘 Challenge description:<br>While scanning their network, you chance upon a tool that checks for the validity of a secret passphrase. You know that they use this phrase for establishing communications between one another, but the one you have is way outdated.<br>It’s time for an update.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Iscaraca/CTF-Challenges/tree/main/tisc2024/baby_flagchecker">Link to source code (including setup files, files given to the participants, and solution script)</a></p>
<p>The website is stupid simple. It’s just one text input with a submit button, and if your passphrase isn’t correct, “Invalid” is flashed on the screen. Participants don’t actually know what’s displayed when the passphrase is correct so we’ll leave that as a surprise for later. </p>
<p><img src="/2024/10/16/tisc-2024/page.png" alt="page"></p>
<h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><h3 id="TLDR"><a href="#TLDR" class="headerlink" title="TLDR"></a>TLDR</h3><p>SSTI to information leak to side channel attack via gas usage</p>
<h3 id="NLDR-Not-long-did-read-Stage-1-SSTI-to-information-leak"><a href="#NLDR-Not-long-did-read-Stage-1-SSTI-to-information-leak" class="headerlink" title="NLDR (Not long did read) - Stage 1: SSTI to information leak"></a>NLDR (Not long did read) - Stage 1: SSTI to information leak</h3><p>Trivially, the input is vulnerable to SSTI. Using standard CTF techniques to enumerate the machine and achieve RCE will be futile as the only instance of the flag is stored on the private blockchain network. Also, there’s a WAF that blocks strings more than 32 characters long. This length check was honestly so I didn’t have to deal with any ABI shenanigans when calling the contract, but I’m glad it had the unintended effect of discouraging people from going down the SSTI rabbit hole.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/submit&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>():</span><br><span class="line">    password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(password) &gt; <span class="number">32</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">            &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;head&gt;</span></span><br><span class="line"><span class="string">                &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;title&gt;Check Result&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;/head&gt;</span></span><br><span class="line"><span class="string">            &lt;body&gt;</span></span><br><span class="line"><span class="string">                &lt;h1&gt;Keyphrase too long!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;a href=&quot;/&quot;&gt;Go back&lt;/a&gt;</span></span><br><span class="line"><span class="string">            &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Rest of endpoint here</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, response_data=response_data)</span><br></pre></td></tr></table></figure>


<p>Looking at <code>app/main.py</code>, we can see that the whole of <code>response_data</code> is passed into Jinja’s context instead of just the output. The object format can be seen in <code>server/connect_to_testnet.py</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> output<span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;contract_address&quot;</span><span class="punctuation">:</span> setup_contract.address<span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;setup_contract_bytecode&quot;</span><span class="punctuation">:</span> os.environ<span class="punctuation">[</span>&#x27;SETUP_BYTECODE&#x27;<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;adminpanel_contract_bytecode&quot;</span><span class="punctuation">:</span> os.environ<span class="punctuation">[</span>&#x27;ADMINPANEL_BYTECODE&#x27;<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secret_contract_bytecode&quot;</span><span class="punctuation">:</span> os.environ<span class="punctuation">[</span>&#x27;SECRET_BYTECODE&#x27;<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gas&quot;</span><span class="punctuation">:</span> gas</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<p>We can leak all this information using the payload <code>&#123;&#123; response_data &#125;&#125;</code>.</p>
<h2 id="Stage-2-Reverse-engineering-the-smart-contract-bytecode"><a href="#Stage-2-Reverse-engineering-the-smart-contract-bytecode" class="headerlink" title="Stage 2: Reverse engineering the smart contract bytecode"></a>Stage 2: Reverse engineering the smart contract bytecode</h2><p>From the previous stage, we get:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;output&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> </span><br><span class="line">&#x27;setup_contract_address&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0x5FC8d32690cc91D4c39d9d3abcBD16989F875707</span>&#x27;<span class="punctuation">,</span> </span><br><span class="line">&#x27;setup_contract_bytecode&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0x608060405234801561001057600080fd5b5060405161027838038061027883398101604081905261002f9161007c565b600080546001600160a01b039384166001600160a01b031991821617909155600180549290931691161790556100af565b80516001600160a01b038116811461007757600080fd5b919050565b6000806040838503121561008f57600080fd5b61009883610060565b91506100a660208401610060565b90509250929050565b6101ba806100be6000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063410eee0214610030575b600080fd5b61004361003e366004610115565b610057565b604051901515815260200160405180910390f35b6000805460015460408051602481018690526001600160a01b0392831660448083019190915282518083039091018152606490910182526020810180516001600160e01b0316635449534360e01b17905290518493849316916100b99161012e565b6000604051808303816000865af19150503d80600081146100f6576040519150601f19603f3d011682016040523d82523d6000602084013e6100fb565b606091505b50915091508061010a9061015d565b600114949350505050565b60006020828403121561012757600080fd5b5035919050565b6000825160005b8181101561014f5760208186018101518583015201610135565b506000920191825250919050565b8051602080830151919081101561017e576000198160200360031b1b821691505b5091905056fea2646970667358221220e0f8333be083b807f8951d4868a6231b41254b2f6157a9fb62eff1bcefafd84e64736f6c63430008130033</span>&#x27;<span class="punctuation">,</span> </span><br><span class="line">&#x27;adminpanel_contract_bytecode&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0x60858060093d393df35f358060d81c64544953437b148160801b60f81c607d1401600214610022575f5ffd5b6004356098636b35340a6060526020606020901b186024356366fbf07e60205260205f6004603c845af4505f515f5f5b82821a85831a14610070575b9060010180600d146100785790610052565b60010161005e565b81600d1460405260206040f3</span>&#x27;<span class="punctuation">,</span> </span><br><span class="line">&#x27;secret_contract_bytecode&#x27;<span class="punctuation">:</span> &#x27;<span class="number">0</span>xREDACTED&#x27;<span class="punctuation">,</span> </span><br><span class="line">&#x27;gas&#x27;<span class="punctuation">:</span> <span class="number">29307</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<p>There are 3 contracts deployed to the network: <code>Setup</code>, <code>AdminPanel</code>, and <code>Secret</code>. <code>Secret</code>‘s bytecode has been redacted, probably because it contains the keyphrase. We still have the bytecode from the other two contracts, however, and can see how our keyphrase is being checked.</p>
<p>Before going into reverse engineering, we can get a better idea of <code>Setup</code> by looking at the server files provided, giving us a better place to start.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uint256 deployerPrivateKey = DEPLOYER_PRIVATE_KEY;</span><br><span class="line">vm.startBroadcast(deployerPrivateKey);</span><br><span class="line">Setup setup = new Setup(address(adminPanel), address(secret));</span><br><span class="line">console2.log(<span class="string">&quot;Setup contract deployed to: &quot;</span>, address(setup));</span><br><span class="line">vm.stopBroadcast();</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># server/contracts/script/Deploy.s.sol</span></span><br><span class="line">passwordEncoded = <span class="string">&#x27;0x&#x27;</span> + <span class="built_in">bytes</span>(password.ljust(<span class="number">32</span>, <span class="string">&#x27;\0&#x27;</span>), <span class="string">&#x27;utf-8&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    gas = setup_contract.functions.checkPassword(passwordEncoded).estimate_gas()</span><br><span class="line">    output = setup_contract.functions.checkPassword(passwordEncoded).call()</span><br></pre></td></tr></table></figure>


<p><code>Setup</code>‘s constructor function takes in two addresses, that of <code>AdminPanel</code> and <code>Secret</code>. It has another external function <code>checkPassword(bytes32)</code> that takes in the keyphrase and outputs a boolean.</p>
<p>We can pass <code>Setup</code>‘s bytecode into any Ethereum Virtual Machine decompiler (this writeup uses free and publically available decompilers like <a target="_blank" rel="noopener" href="https://onchainplay.fly.dev/">heimdall</a> and <a target="_blank" rel="noopener" href="https://app.dedaub.com/decompile">dedaub</a>, but if you want to look at the disassembly that’s fine too, the contracts in this challenge are really small) and look at the output. Since the bytecode includes the constructor, only the deployment code appears at first:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">uint160 ___function_selector__; // STORAGE[0x0] bytes 0 to 19</span><br><span class="line">uint160 stor_1_0_19; // STORAGE[0x1] bytes 0 to 19</span><br><span class="line"></span><br><span class="line">function function_selector() public payable &#123; </span><br><span class="line">    ...</span><br><span class="line">    ___function_selector__ = MEM[MEM[64]];</span><br><span class="line">    stor_1_0_19 = MEM[MEM[64] + 32];</span><br><span class="line">    MEM[0:442] = 0x6080...;</span><br><span class="line">    return MEM[0:442];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>We see the addresses of <code>AdminPanel</code> and <code>Secret</code> saved into EVM storage, and some bytecode getting returned from the function. This will be the deployed bytecode of <code>Setup</code> where our <code>checkPassword</code> function is. We can copy the string and decompile it once more:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">bytes32 store_b;</span><br><span class="line">bytes32 store_a;</span><br><span class="line"></span><br><span class="line">function Unresolved_410eee02(uint256 arg0) public payable returns (bool) &#123;</span><br><span class="line">    uint256 var_a = arg0;</span><br><span class="line">    address var_b = address(store_a);</span><br><span class="line">    uint256 var_c = 0x44 + (var_d - var_d);</span><br><span class="line">    uint256 var_d = var_d + 0x64;</span><br><span class="line">    uint224 var_e = 0x5449534300000000000000000000000000000000000000000000000000000000 | (uint224(var_f));</span><br><span class="line">    uint256 var_g = 0;</span><br><span class="line">    (bool success, bytes memory ret0) = address(store_b).call&#123; gas: gasleft(), value: var_g &#125;(abi.encode());</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><code>bytes32 store_b</code> is <code>AdminPanel</code>‘s address, and <code>bytes32 store_a</code> is <code>Secret</code>‘s. Function <code>Unresolved_410eee02</code> is almost certainly <code>checkPassword</code>, and our keyphrase is being passed in as <code>arg0</code>. A call is being done on a function in <code>AdminPanel</code> using solidity’s ABI specification, which you can read <a target="_blank" rel="noopener" href="https://docs.soliditylang.org/en/latest/abi-spec.html">here</a>. Knowing how the ABI works is pretty much the crux of this stage since the AdminPanel contract has been obfuscated with a non-standard function selector and calldata retrieval method. Details of the CALL instruction are as follows:</p>
<table>
<thead>
<tr>
<th>Stack Input</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>gas</td>
<td>Amount of gas to send to the sub context to execute. The gas that is not used by the sub context is returned to this one.</td>
</tr>
<tr>
<td>address</td>
<td>The account whose context to execute.</td>
</tr>
<tr>
<td>value</td>
<td>Value in wei to send to the account.</td>
</tr>
<tr>
<td>argsOffset</td>
<td>Byte offset in the memory in bytes, the calldata of the sub context.</td>
</tr>
<tr>
<td>argsSize</td>
<td>Byte size to copy (size of the calldata).</td>
</tr>
<tr>
<td>retOffset</td>
<td>Byte offset in the memory in bytes, where to store the return data of the sub context.</td>
</tr>
<tr>
<td>retSize</td>
<td>Byte size to copy (size of the return data).</td>
</tr>
</tbody></table>
<p>In the evm, when a call is made to a smart contract, both the function to call and its arguments are passed as one long bytestring referred to as <code>args</code>. The first 4 bytes of this bytestring are reserved for the function signature, which specifies the function to call within the contract. All data after the signature are the function arguments, and each argument takes exactly 32 bytes. This is, of course, assuming that the contract was compiled with these standards in mind. The <code>AdminPanel</code> contract was not.</p>
<p>Let’s reverse engineer it along with <code>Setup</code> to help us understand how the call is done. Removing the constructor and decompiling is finnicky with most online tools (as the instructions were written manually), but luckily this contract is tiny and the disassembly is a mere 88 instructions long (as the instructions were written manually). Simply referring to the <a target="_blank" rel="noopener" href="https://www.evm.codes/">evm opcode reference</a> and tracing the stack is enough to debug most problematic decompiler outputs and give you this function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function (bytes4 function_signature, uint256 varg1, uint256 varg2) public payable &#123; </span><br><span class="line">    require(0x544953437B == args[0:5]);</span><br><span class="line">    require(0x7D == args[16]);</span><br><span class="line">    v0 = varg2.delegatecall(0x66fbf07e).gas(msg.gas);</span><br><span class="line">    i = num_of_chars_correct = 0;</span><br><span class="line">    while (1) &#123;</span><br><span class="line">        if ((keccak256(0x6b35340a) &lt;&lt; 152 ^ varg1)[v1] == v0[v1]) &#123;</span><br><span class="line">            num_of_chars_correct += 1;</span><br><span class="line">        &#125;</span><br><span class="line">        i += 1;</span><br><span class="line">        if (i == 13) &#123;</span><br><span class="line">            return num_of_chars_correct == 13;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>It’s apparent that this function is doing a character-by-character comparison of two strings. The first string is the first argument to the function XORed with some key, and the second is the result of a delegatecall to the contract at the address specified by our second argument. Cross-referencing the <code>Setup</code> contract, it’s clear that the second argument is the address to the <code>Secret</code> contract, and the first is our submitted keyphrase. Note that there are also checks on the <code>args</code> bytestring as a whole at the start of the function</p>
<p>The <code>args</code> used to call <code>AdminPanel</code> would therefore have to look something like this:</p>
<table>
<thead>
<tr>
<th>Size</th>
<th>Data</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>4 bytes</td>
<td>0x54495343</td>
<td>Function signature</td>
</tr>
<tr>
<td>32 bytes</td>
<td>0x7B??????????????????????7D000000…</td>
<td>Keyphrase</td>
</tr>
<tr>
<td>32 bytes</td>
<td>0x????…</td>
<td>Address of Secret contract</td>
</tr>
</tbody></table>
<p>Chaining all these arguments together into the ABI encoded bytestring, we get:</p>
<p><code>0x544953437B??????????????????????7D0000...??????...</code></p>
<p>Note how the function signature and the keyphrase form a contiguous section that decodes to <code>TISC&#123;???????????&#125;</code>. This is obviously the flag, but we can’t look at the <code>Secret</code> contract to see what its being compared to. What now?</p>
<h2 id="Stage-3-Side-channel-attack-using-calculated-gas-estimate"><a href="#Stage-3-Side-channel-attack-using-calculated-gas-estimate" class="headerlink" title="Stage 3: Side channel attack using calculated gas estimate"></a>Stage 3: Side channel attack using calculated gas estimate</h2><p>This premise, combined with the odd character-by-character comparison between the strings instead of using the EQ instruction, intuitively tells us that there’s some form of blind attack we need to find some side channel for, but coming up with a definite solution is tricky. The key thing to note here is how the evm calculates gas prices for each transaction.</p>
<p>When you make a transaction or call a function, there are gas fees involved that are paid to the validators. How this gas fee is calculated is based on the evm instructions ran per transaction. Each opcode corresponds to a set gas value, and throughout the execution of the code, these gas values are tallied up to give a numerical estimate for the computational cost of the transaction. This number is then multiplied by the current cost of gas to get the final fee.</p>
<p>In the debugging information we managed to leak earlier, we can see the total gas value our transaction has used. The interesting thing about this value is that it changes based on the path the transaction takes down the control flow of the program, as the number of instructions ran through varies. We can use this idea to do a side-channel attack using the gas value as our metric.</p>
<p>When a successful character comparison is done, the control flow deviates and runs one extra line of code:</p>
<p><code>num_of_chars_correct += 1;</code></p>
<p>In the disassembly output, this deviation corresponds to these instructions:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x70: JUMPDEST  	    1 gas</span><br><span class="line">0x71: PUSH1     0x1	    3 gas</span><br><span class="line">0x73: ADD       	    3 gas</span><br><span class="line">0x74: PUSH2     0x5e	3 gas</span><br><span class="line">0x77: JUMP		        8 gas</span><br></pre></td></tr></table></figure>


<p>which adds up to 18 gas total. This means that for every correct character in our keyphrase, the gas value will increase by 18. Submitting</p>
<p><code>&#123;00000000000&#125;&#123;&#123; response_data &#125;&#125;</code></p>
<p>and reading the gas value gives us 33365, but submitting</p>
<p><code>&#123;g0000000000&#125;&#123;&#123; response_data &#125;&#125;</code></p>
<p>gives us a value of 33383, telling us that our flag starts with g. We can do the same to all the characters in the flag with the script in <code>solve.py</code> to get the flag!</p>
<p><code>TISC&#123;g@s_Ga5_94S&#125;</code></p>
<h2 id="Thoughts"><a href="#Thoughts" class="headerlink" title="Thoughts"></a>Thoughts</h2><p>I came up with the idea of doing a gas side channel attack in my sleep. </p>
<p>I was stressed the hell out coming up with an idea to best all other previous CTF challenges I’ve made thus far (and I’ll be the first to say they’re all really good challenges), and I was convinced that EVM was the way to go since I’d been doing so much research into it lately, but nothing really clicked. I tried making an EVM pwn before this, but I had to do so many weird things that people wouldn’t normally do to make a pointer overwrite possible, and I don’t like it when CTF challenges just do the most unbelievable things that no sane developer would do just to get a point across.</p>
<p>It was a real eureka moment for me, using the gas estimate as a means to count instructions. I don’t think I’ve seen this exploit being documented online before (partially because not a lot of people deploy contracts to private networks), and it was a good opportunity to introduce the concept of the evm and gas calculations to participants. I was so excited (ask anyone in the office on that day) since I had been struggling on a challenge idea for literal weeks.</p>
<h2 id="Making-the-challenge"><a href="#Making-the-challenge" class="headerlink" title="Making the challenge"></a>Making the challenge</h2><p>If you look at the contracts’ source code, you’ll notice that instead of solidity, they’re written in an evm-level language called Huff. I’ll put the contract code here for convenience:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">/* AdminPanel.huff */</span><br><span class="line">/* Interface */</span><br><span class="line">#define function checkPassword(address,bytes32) nonpayable returns (bytes32)</span><br><span class="line"></span><br><span class="line">/* Methods */</span><br><span class="line">#define macro CHECK_PASSWORD() = takes (0) returns (5) &#123;</span><br><span class="line">    0x04 calldataload           // [password]</span><br><span class="line"></span><br><span class="line">    // XOR with secret key      </span><br><span class="line">    0x98                        // [length, plaintext]</span><br><span class="line">    0x6b35340a 0x60 mstore      // [length, plaintext]</span><br><span class="line">    0x20 0x60 sha3              // [hash, length, plaintext]</span><br><span class="line">    swap1 shl xor               // [xoredPlaintext]</span><br><span class="line"></span><br><span class="line">    0x24 calldataload           // [secretAddr, password]</span><br><span class="line"></span><br><span class="line">    // Store function signature in memory</span><br><span class="line">    0x66fbf07e 0x20 mstore</span><br><span class="line"></span><br><span class="line">    // Retrieve password from external contract</span><br><span class="line">    0x20 0x00 0x04 0x3C dup5 gas delegatecall</span><br><span class="line"></span><br><span class="line">    pop 0x00 mload              // [secret, secretAddr, password]</span><br><span class="line"></span><br><span class="line">    // Push itercount and correctCount to the stack</span><br><span class="line">    0x00 0x00                   // [correctCount, itercount, secret, secretAddr, password]</span><br><span class="line"></span><br><span class="line">    iterativeCheck:</span><br><span class="line">        dup3 dup3 byte          // [secretNth, correctCount, itercount, secret, secretAddr, password]</span><br><span class="line">        dup6 dup4 byte          // [flagNth, secretNth, correctCount, itercount, secret, secretAddr, password]</span><br><span class="line">        eq correctChar jumpi    // [correctCount, itercount, secret, secretAddr, password]</span><br><span class="line"></span><br><span class="line">    iterativeCheckAfterJump:</span><br><span class="line">        swap1 0x01 add          // [itercount++, correctCount, secret, secretAddr, password]</span><br><span class="line">        dup1 0x0D eq end jumpi  // [itercount, correctCount, secret, secretAddr, password]</span><br><span class="line">        swap1                   // [correctCount, itercount, secret, secretAddr, password]</span><br><span class="line">        iterativeCheck jump</span><br><span class="line"></span><br><span class="line">    correctChar:</span><br><span class="line">        0x01 add                // [correctCount++, itercount, secret, secretAddr, password]</span><br><span class="line">        iterativeCheckAfterJump jump</span><br><span class="line"></span><br><span class="line">    end:</span><br><span class="line">        dup2 0x0D eq            // [correct?, itercount, correctCount, secret, secretAddr, password]</span><br><span class="line">        0x40 mstore             // [itercount, correctCount, secret, secretAddr, password]</span><br><span class="line">    </span><br><span class="line">    0x20 0x40 return</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#define macro MAIN() = takes (0) returns (1) &#123;</span><br><span class="line">    // Check for flag format</span><br><span class="line">    0x00 calldataload           // [&quot;TISC&#123;###########&#125;&quot;]</span><br><span class="line">    </span><br><span class="line">    dup1 0xD8 shr               // [&quot;TISC&#123;&quot;, &quot;TISC&#123;###########&#125;&quot;]</span><br><span class="line">    0x544953437B eq             // [1, &quot;TISC&#123;###########&#125;&quot;]</span><br><span class="line">    dup2 0x80 shl 0xF8 shr      // [&quot;&#125;&quot;, 1, &quot;TISC&#123;###########&#125;&quot;]</span><br><span class="line">    0x7D eq                     // [1, 1, &quot;TISC&#123;###########&#125;&quot;]</span><br><span class="line">    add 0x02 eq checkPassword jumpi</span><br><span class="line"></span><br><span class="line">    0x00 0x00 revert</span><br><span class="line"></span><br><span class="line">    checkPassword:</span><br><span class="line">        CHECK_PASSWORD()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/* Secret.huff */</span><br><span class="line">/* Interface */</span><br><span class="line">#define function secretP1ssp00r() nonpayable returns (bytes32)</span><br><span class="line"></span><br><span class="line">/* Methods */</span><br><span class="line">#define macro SECRET_P1SSP00R() = takes (0) returns (0) &#123;</span><br><span class="line">    // Store &quot;&#123;g@s_Ga5_94S&#125;&quot; encrypted in memory for return</span><br><span class="line">    0xDEAF50391118A37595C50AC9F700000000000000000000000000000000000000 0x00 mstore</span><br><span class="line"></span><br><span class="line">    // End Execution</span><br><span class="line">    0x20 0x00 return </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#define macro MAIN() = takes (0) returns (0) &#123;</span><br><span class="line">    // Identify which function is being called.</span><br><span class="line">    0x00 calldataload 0xE0 shr</span><br><span class="line">    dup1 __FUNC_SIG(secretP1ssp00r) eq secretP1ssp00r jumpi</span><br><span class="line"></span><br><span class="line">    0x00 0x00 revert</span><br><span class="line"></span><br><span class="line">    secretP1ssp00r:  // So that people cant find this on 4 byte signature databases</span><br><span class="line">        SECRET_P1SSP00R()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>The reason for this is that I was running out of time to submit the challenge, so I couldn’t draft an applicable control flow graph that solidity would compile to before the deadline. Because of this, I chose to implement the most textbook example of a function vulnerable to side channel attacks, which involved writing the instructions manually in huff since I didn’t have time to deal with compiler shenanigans.</p>
<p>Next time I make this challenge, it’ll be a huge CFG with multiple paths so you actually have to do some math to arrive at the solution.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://Iscaraca.github.io">Iscara</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://iscaraca.github.io/2024/10/16/tisc-2024/">http://iscaraca.github.io/2024/10/16/tisc-2024/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Challenge-Creation/">Challenge Creation</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/05/04/cyberthon-2024/" title="Cyberthon 2024 - The Galaxy's Best Smuggler"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Cyberthon 2024 - The Galaxy's Best Smuggler</div></div><div class="info-2"><div class="info-item-1">Cyberthon is an annual CTF competition targeted towards JC students in Singapore. This year, I had the opportunity to author a challenge for the web category: The Galaxy’s Best Smuggler. At the end of this writeup are my thoughts on challenge creation. Challenge 📘 Challenge description: “Ever heard of sabacc?” “I’ve played it a couple times.” You eye the stifling pile of credit on Lando’s side of the table, allowing yourself a wry smile. “Having a good day, I reckon.” “Oh, you ain’t seen...</div></div></div></a><a class="pagination-related" href="/2025/02/14/valentines-2025/" title="Valentine's Day 2025 Puzzle - Shot Through The Heart"><img class="cover" src="/2025/02/14/valentines-2025/shot-through-the-heart.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Valentine's Day 2025 Puzzle - Shot Through The Heart</div></div><div class="info-2"><div class="info-item-1"> Classic Shakashaka rules apply.Red lines must lie on the edges of rectangles. Solve the puzzle on Penpa. Happy Valentine’s Day! </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/05/04/cyberthon-2024/" title="Cyberthon 2024 - The Galaxy&#39;s Best Smuggler"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-04</div><div class="info-item-2">Cyberthon 2024 - The Galaxy&#39;s Best Smuggler</div></div><div class="info-2"><div class="info-item-1">Cyberthon is an annual CTF competition targeted towards JC students in Singapore. This year, I had the opportunity to author a challenge for the web category: The Galaxy’s Best Smuggler. At the end of this writeup are my thoughts on challenge creation. Challenge 📘 Challenge description: “Ever heard of sabacc?” “I’ve played it a couple times.” You eye the stifling pile of credit on Lando’s side of the table, allowing yourself a wry smile. “Having a good day, I reckon.” “Oh, you ain’t seen...</div></div></div></a><a class="pagination-related" href="/2023/10/21/tisc-2023/" title="TISC 2023 - Blind SQL Injection"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="info-item-2">TISC 2023 - Blind SQL Injection</div></div><div class="info-2"><div class="info-item-1">TISC is a two-week online sequential style CTF competition hosted by CSIT, where participants solve a series of 10 challenges. Over 1000 participants took on the challenges, with the top three levels of challenges having a cash prize pool of $10,000 each to be shared between participants who successfully cleared the respective levels. I was given the opportunity to create the challenge at level 8, and I’ll be sharing the writeup as well as a few of my thoughts at the end of the blog...</div></div></div></a><a class="pagination-related" href="/2023/08/01/cyberthon-2023/" title="Cyberthon 2023 - Astockalypse (Author Writeup + Notes)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="info-item-2">Cyberthon 2023 - Astockalypse (Author Writeup + Notes)</div></div><div class="info-2"><div class="info-item-1">Cyberthon is an annual CTF competition targeted towards JC students in Singapore, jointly organised by HCI, CSIT, and the DIS. This year, I had the opportunity to author a challenge for the data science category, and Astockalypse was what I came up with. At the end of this writeup are my thoughts before, during and after challenge creation, and how I could’ve improved from a creative and a technical standpoint. Challenge 📘 Challenge description: One of your agents has found a proprietary...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Iscara</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Iscaraca" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/isaaccjd/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin-in" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge"><span class="toc-number">1.</span> <span class="toc-text">Challenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Writeup"><span class="toc-number">2.</span> <span class="toc-text">Writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TLDR"><span class="toc-number">2.1.</span> <span class="toc-text">TLDR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NLDR-Not-long-did-read-Stage-1-SSTI-to-information-leak"><span class="toc-number">2.2.</span> <span class="toc-text">NLDR (Not long did read) - Stage 1: SSTI to information leak</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-2-Reverse-engineering-the-smart-contract-bytecode"><span class="toc-number">3.</span> <span class="toc-text">Stage 2: Reverse engineering the smart contract bytecode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-3-Side-channel-attack-using-calculated-gas-estimate"><span class="toc-number">4.</span> <span class="toc-text">Stage 3: Side channel attack using calculated gas estimate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thoughts"><span class="toc-number">5.</span> <span class="toc-text">Thoughts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Making-the-challenge"><span class="toc-number">6.</span> <span class="toc-text">Making the challenge</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-color: #0e1111;"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Iscara</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="What are you looking for?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>